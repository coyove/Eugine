(struct Template "HTML Templates"
	[::site-name := Config::site-name]
	[::make-header := (lambda (context title)
		(join-string (~include "header.html") "")
	)]

    [::build-posts := (lambda (posts)
        (var table clone "<table border=1>")
        (roop posts [(post) =>
            (+. table
"<tr>
    <td>" post::Comments "</td>
    <td>" post::points "</td>
    <td><a href='/item/" post::id "'>" (escape-html post::Title) "</a></td>
    <td><a href='/user/" post::Author "'>" post::Author "</a></td>
    <td>" (pretty-date post::CommentedTS) " ago</td>
</tr>")
        ])
        (+. table "</table>")
        (table)
    )]

	[::index := (lambda (context posts start)
        (var index (join-string (~include "index.html") ""))
        (var footer (join-string (~include "footer.html") ""))

        (+ (::make-header context "Index") (sprintf index (::build-posts posts)) footer)
    )]

    [::item := (lambda (context item comments)
        (var item-page (join-string (~include "item.html") ""))
        (var footer (join-string (~include "footer.html") ""))

        (+ (::make-header context item::Title) (sprintf item-page (::build-posts comments)) footer)
    )]

	[::submit := (lambda (context)
        (var submit (join-string (~include "submit.html") ""))
        (var footer (join-string (~include "footer.html") ""))

        (+ (::make-header context "Submit") submit footer)
     )]

	[::login := (lambda (context)
        (var login (join-string (~include "login.html") ""))
        (var footer (join-string (~include "footer.html") ""))

        (+ (::make-header context "Log in") login footer)
    )]

	[::welcome := (lambda (context)
        (var welcome (join-string (~include "welcome.html") ""))
        (var footer (join-string (~include "footer.html") ""))

        (+ (::make-header context "Welcome") (sprintf welcome context::username) footer)
    )]

    [::member-info := (lambda (context user-data)
        (var sign-up (num [user-data : UserOp::SIGN_UP_TS]))
        (var age [(time 1) - sign-up])
        (set age / age 86400000)
        (var member-info (join-string (~include "member.html") ""))
        (var footer (join-string (~include "footer.html") ""))

        (+ (::make-header context "Member") member-info footer)
    )]

    [::error := (lambda (context text)
        (var footer (join-string (~include "footer.html") ""))

        (+ (::make-header context "Error") "<div class='error'>" text "</div>" footer)
    )]

    [::warning := (lambda (context text)
        (var footer (join-string (~include "footer.html") ""))

        (+ (::make-header context "Warning") "<div class='warning'>" text "</div>" footer)
    )]
)