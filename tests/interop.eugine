
;(set p read-from-console)
;(set f (new (cls @java.io.File) @java.lang.String p))
;(println (type [f . @exists ()]))

(assert (== "1"
	[(cls @org.apache.commons.lang3.StringUtils) . @getCommonPrefix (list @java.lang.String...) ("1" "12" "123")])
	"Java interop (string)")

(assert (eq ["" . @format (@java.lang.String @java.lang.Object...) "hello %s %.2f" (list "world" 1.0)] 
	"hello world 1.00") "Java interop (format)")

(def new' (class-name arg...) {
    (if [(len arg) == 0]
        (new (cls class-name) ())
        (new (cls class-name) (list [arg : 0]) [arg : 1])
    )
})

[result = new' @java.lang.StringBuilder]
[url = new' @java.net.URL @java.lang.String "http://example.com/"]
[conn = [url . @openConnection()]]
[conn . @setRequestMethod (list @java.lang.String) "GET"]

[isr = [conn . @getInputStream ()]]
[rd = new' @java.io.BufferedReader @java.io.Reader (new' @java.io.InputStreamReader @java.io.InputStream isr)]
[line = ""]

(loop [(set line [rd . @readLine ()]) != null] [() => [result . @append (list @java.lang.String) line]])

[rd . @close ()]
(assert [(sub [result . @toString ()] 0 6) == "<html>"] "Java interop (net)")